<!-- Contenedor principal que espera los datos del estudiante -->
<div class="student-dashboard-container" *ngIf="studentData$ | async as data; else loading">

  <!--  MEJORA: Pantalla de Bienvenida Motivacional -->
  <div *ngIf="showWelcomeScreen" class="welcome-screen">
    <div class="welcome-content">
      <h1 class="welcome-title">隆Hola, {{ data.profile.name }}!</h1>
      <p class="welcome-subtitle">
        Bienvenido a tu espacio en SIMPADE. Aqu铆, tu progreso y tu voz son lo m谩s importante.
        Estamos para apoyarte en cada paso de tu camino educativo.
      </p>
      <button (click)="proceedToStatusView()" class="btn btn-primary btn-cta">
        隆Estoy listo! Ver mi estado
      </button>
    </div>
  </div>

  <!-- Vista del Estado (se muestra despu茅s de hacer clic en el bot贸n) -->
  <div *ngIf="!showWelcomeScreen">
    <div class="header">
      <h2>Mi Estado en SIMPADE</h2>
      <p>Aqu铆 puedes consultar tu progreso y dejar tus comentarios para mejorar la convivencia.</p>
    </div>

    <!-- Tarjeta con la Informaci贸n del Estudiante -->
    <div class="card status-card" *ngIf="data.details">
      <h3>Tu Informaci贸n (Simulada)</h3>
      <div class="status-grid">
        <div class="status-item">
          <span class="label">Riesgo Actual:</span>
          <span class="value">{{ data.details.riskFactor }}</span>
        </div>
        <div class="status-item">
          <span class="label">ltimas Ausencias:</span>
          <span class="value">{{ data.details.absencesLastMonth }}</span>
        </div>
        <div class="status-item">
          <span class="label">Promedio General:</span>
          <span class="value">{{ data.details.academicAverage | number:'1.1-2' }}</span>
        </div>
      </div>
    </div>
    <div *ngIf="!data.details" class="alert error-alert">
      No se pudieron cargar los detalles de tu progreso. Por favor, contacta a tu docente.
    </div>

    <!-- Tarjeta con el Formulario de Feedback -->
    <div class="card feedback-card">
      <h3>驴C贸mo te sientes? 隆Tu opini贸n importa!</h3>
      <form [formGroup]="feedbackForm" (ngSubmit)="submitFeedback()">
        <div class="form-group">
          <label for="feeling">驴C贸mo te sientes en el colegio?</label>
          <select id="feeling" formControlName="feeling" class="form-control">
            <option>Excelente</option>
            <option>Bien</option>
            <option>Regular</option>
            <option>Necesito apoyo</option>
          </select>
        </div>
        <div class="form-group">
          <label for="category">Categor铆a</label>
          <select id="category" formControlName="category" class="form-control">
            <option>Convivencia</option>
            <option>Acad茅mico</option>
            <option>Instalaciones</option>
            <option>Otro</option>
          </select>
        </div>
        <div class="form-group">
          <label for="suggestion">驴Qu茅 te gustar铆a mejorar?</label>
          <textarea id="suggestion" formControlName="suggestion" rows="4" class="form-control"></textarea>
        </div>
        <button type="submit" class="btn btn-accent">Enviar Mi Opini贸n</button>
      </form>
    </div>
  </div>
</div>

<!-- Template para el estado de carga -->
<ng-template #loading>
  <div class="loading-container">
    <p>Cargando tu informaci贸n...</p>
  </div>
</ng-template>

